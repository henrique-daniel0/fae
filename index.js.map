{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 63fe9f9cb77c5088adf5","webpack:///./src/vector.js","webpack:///./src/core/event-listener.js","webpack:///./src/core/index.js","webpack:///./src/components/animatedsprite.js","webpack:///./src/components/collision.js","webpack:///./src/components/emitter.js","webpack:///./src/components/index.js","webpack:///./src/components/motion.js","webpack:///./src/components/sprite.js","webpack:///./src/components/steering.js","webpack:///./src/core/application.js","webpack:///./src/core/component.js","webpack:///./src/core/entity.js","webpack:///./src/core/scene.js","webpack:///./src/core/system.js","webpack:///./src/systems/collision.js","webpack:///./src/systems/index.js","webpack:///./src/systems/particles.js","webpack:///./src/systems/physics.js","webpack:///./src/systems/steering.js","webpack:///./src/index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;AC3FA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;;AAEA,wCAAwC,sCAAsC,EAAE;;AAEhF;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;AC5CiC;;;;;;;;ACAjC;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,eAAe,+CAA+C;AAC9D;;AAEA;AACA;AACA;;;;;;;;;ACzCA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,4CAA4C,EAAE;AAC9D,iBAAiB,6BAA6B,EAAE;AAChD,eAAe,6CAA6C,EAAE;AAC9D,kBAAkB,2BAA2B,EAAE;;AAE/C;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACrBA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACXiB;AACE;AACC;;AAEH;AACQ;;AAEP;;;;;;;;;ACPlB;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;ACZA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,2BAA2B,8BAA8B;AACzD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;AClHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;;;;;;;;;;ACjCA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gCAAgC,8BAA8B;AAC9D;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,qFAAmC;AACvD,qBAAqB,8BAA8B;;AAEnD;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,uCAAuC,sBAAsB;AAC7D;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;AC5FA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;AClBA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AAAA;AAAA;;;;;;;;AC9BA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,2BAA2B,qBAAqB;AAChD;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;ACpFmB;AACD;AACE;AACA;;;;;;;;;ACHpB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;AC1GA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACTA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;AC5BA;;AAE4B","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"fae\"] = factory();\n\telse\n\t\troot[\"fae\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 20);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 63fe9f9cb77c5088adf5","export default class Vector {\n    constructor(x = 0, y = 0) {\n        if (typeof x == \"object\") {\n            this.x = x.x;\n            this.y = x.y;\n        } else {\n            this.x = x;\n            this.y = y;\n        }\n    }\n\n    // Getter properties\n    get length() {\n        return Math.sqrt(Math.pow(this.x, 2) + Math.pow(this.y, 2));\n    }\n\n    get normalized() {\n        return this.copy().normalize();\n    }\n\n    // Arithmetic\n    plus(v) {\n        return this.copy().add(v);\n    }\n\n    minus(v) {\n        return this.copy().subtract(v);\n    }\n\n    times(n) {\n        return this.copy().multiply(n);\n    }\n\n    divided(n) {\n        return this.copy().divide(n);\n    }\n\n    // Assignment Arithmetic\n    add(v) {\n        this.x += v.x;\n        this.y += v.y;\n        return this;\n    }\n\n    subtract(v) {\n        this.x -= v.x;\n        this.y -= v.y;\n        return this;\n    }\n\n    multiply(n) {\n        this.x *= n;\n        this.y *= n;\n        return this;\n    }\n\n    divide(n) {\n        this.x /= n;\n        this.y /= n;\n        return this;\n    }\n\n    // Manipulation\n    copy() {\n        return new Vector(this.x, this.y);\n    }\n\n    set(x, y) {\n        if (y === undefined) y = x;\n        this.x = x;\n        this.y = y;\n        return this;\n    }\n\n    normalize() {\n        let l = this.length;\n        if (l > 0) {\n            this.x /= l;\n            this.y /= l;\n        }\n        return this;\n    }\n\n    truncate(n) {\n        let s = n / this.length;\n        if (s < 1) {\n            this.x *= s;\n            this.y *= s;\n        }\n        return this;\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/vector.js\n// module id = 0\n// module chunks = 0","export default function mixinEventListener(object) {\n    object.callbacks = {};\n\n    const methods = {\n        bind(eventName, callback) {\n            if (!this.callbacks[eventName]) this.callbacks[eventName] = [];\n\n            return this.callbacks[eventName].push(callback) - 1;\n        },\n\n        once(eventName, callback) {\n            const id = this.bind(eventName, callback);\n\n            this.bind(eventName, () => { this.unbind(eventName, [id, id + 1]); }, this);\n\n            return id;\n        },\n\n        unbind(eventName, id) {\n            if (this.callbacks[eventName]) {\n                if (id === undefined) {\n                    this.callbacks[eventName] = undefined;\n                }\n                else if (typeof id == \"number\") {\n                    this.callbacks[eventName][id] = undefined;\n                }\n                else for (const i of id) {\n                    this.callbacks[eventName][i] = undefined;\n                }\n            }\n        },\n\n        fire(eventName, data) {\n            if (this.callbacks[eventName]) {\n                for (const callback of this.callbacks[eventName]) {\n                    if (callback) callback.call(this, data);\n                }\n            }\n        }\n    };\n\n    for (const key in methods) {\n        object[key] = methods[key].bind(object);\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/event-listener.js\n// module id = 1\n// module chunks = 0","export { default as Application } from \"./application\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/index.js\n// module id = 2\n// module chunks = 0","export const animatedsprite = {\n    attach() {\n        // TODO: placeholder sprite?\n        this.as = new AnimatedSprite([this.app.resources.mage.array[0]]);\n        this.addChild(this.as);\n    },\n\n    remove() {\n        this.removeChild(this.as);\n        this.as.destroy();\n        delete this.as;\n    }\n};\n\nclass AnimatedSprite extends PIXI.extras.AnimatedSprite {\n    constructor(textures) {\n        super(textures);\n\n        this.animations = {};\n        this.currentAnimation = null;\n    }\n\n    addAnimation(name, animation) {\n        this.animations[name] = animation;\n    }\n\n    playAnimation(name) {\n        if (this.currentAnimation == name) return;\n        this.currentAnimation = name;\n\n        this.onFrameChange = function() {\n            // TODO: replace 60 w/ app.ticker.FPS\n            this.animationSpeed = this.animations[name].speed / 60;\n\n            if (this.currentFrame > this.animations[name].end ||\n                this.currentFrame < this.animations[name].start\n            ) { this.gotoAndPlay(this.animations[name].start); }\n        };\n\n        this.play();\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/animatedsprite.js\n// module id = 3\n// module chunks = 0","import Vector from \"../vector\";\n\nexport const collision = {\n    w: 0,\n    h: 0,\n    r: null,\n    sleeping: false,\n    drawCollider: false,\n\n    get left() {    return this.x - this.w * this.cAnchor.x; },\n    get right() {   return this.left + this.w; },\n    get top() {     return this.y - this.h * this.cAnchor.y; },\n    get bottom() {  return this.top + this.h; },\n\n    attach() {\n        this.cAnchor = new Vector();\n    },\n\n    remove() {\n        delete this.cAnchor;\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/collision.js\n// module id = 4\n// module chunks = 0","export const emitter = {\n    emitting: true,\n    emitTimer: 0,\n\n    attach() {\n        this.emitOptions = {};\n    },\n\n    remove() {\n        delete this.emitOptions;\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/emitter.js\n// module id = 5\n// module chunks = 0","export { motion } from \"./motion\";\nexport { steering } from \"./steering\";\nexport { collision } from \"./collision\";\n\nexport { sprite } from \"./sprite\";\nexport { animatedsprite } from \"./animatedsprite\";\n\nexport { emitter } from \"./emitter\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/index.js\n// module id = 6\n// module chunks = 0","import Vector from \"../vector\";\n\nexport const motion = {\n    attach() {\n        this.velocity = new Vector();\n    },\n\n    remove() {\n        delete this.velocity;\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/motion.js\n// module id = 7\n// module chunks = 0","export const sprite = {\n    attach() {\n        // TODO: placeholder sprite?\n        this.sprite = new PIXI.Sprite(this.app.resources.mage.array[0]);\n        this.addChild(this.sprite);\n    },\n\n    remove() {\n        this.removeChild(this.sprite);\n        this.sprite.destroy();\n        delete this.sprite;\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/sprite.js\n// module id = 8\n// module chunks = 0","import Vector from \"../vector\";\n\nexport const steering = {\n    require: [\"motion\"],\n\n    moveSpeed: 5,\n    turnSpeed: 1,\n\n    steer: true,\n    chaseVec: null,\n    avoidVecs: [],\n\n    attach() {\n        this.desiredVelocity = new Vector();\n    },\n\n    remove() {\n        delete this.desiredVelocity;\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/steering.js\n// module id = 9\n// module chunks = 0","import Entity from \"./entity\";\nimport Component from \"./component\";\nimport System from \"./system\";\nimport Scene from \"./scene\";\nimport Vector from \"../vector\";\n\nimport * as components from \"../components\";\nimport * as systems from \"../systems\";\n\nimport mixinEventListener from \"./event-listener\";\n\nexport default class Application extends PIXI.Application {\n    constructor(width, height, options, noWebGL) {\n        super(width, height, options, noWebGL);\n        mixinEventListener(this);\n\n        this.loader = new PIXI.loaders.Loader();\n        this.resources = this.loader.resources;\n\n        this.entities = [];\n        this.components = {};\n        this.systems = [];\n        this.scenes = {};\n\n        this.destroyQueue = [];\n\n        this.stage.particles = this.stage.addChild(new PIXI.particles.ParticleContainer());\n        this.stage.particles.blendMode = PIXI.BLEND_MODES.ADD;\n        this.stage.particles.setProperties({\n            scale: true,\n            position: true,\n            rotation: true,\n            alpha: true\n        });\n\n        // Set up debug graphics overlay\n        this.stage.graph = this.stage.addChild(new PIXI.Graphics());\n        this.bind(\"update\", () => {\n            this.stage.graph.clear();\n        });\n\n        // Load default components and systems\n        for (const component in components) {\n            this.c(component, components[component]);\n        }\n\n        for (const system in systems) {\n            this.s(systems[system]);\n        }\n\n        // Set up input\n        const interaction = this.renderer.plugins.interaction;\n        const stage = this.stage;\n        this.stage.interactive = true;\n\n        this.input = {\n            pointerDown: false,\n            get pointerPos() {\n                return new Vector(\n                    interaction.pointer.global.x / stage.scale.x,\n                    interaction.pointer.global.y / stage.scale.y\n                );\n            }\n        };\n\n        this.stage.on(\"pointerdown\", () => {\n            this.input.pointerDown = true;\n        });\n\n        this.stage.on(\"pointerup\", () => {\n            this.input.pointerDown = false;\n        });\n\n        this.view.addEventListener(\"contextmenu\", (event) => {\n            event.preventDefault();\n        });\n\n        // Start firing update events\n        this.ticker.add(() => {\n            for (let i = 0; i < this.destroyQueue.length; i++) {\n                this.destroyQueue[i].destroy();\n            }\n            this.destroyQueue = [];\n\n            this.fire(\"update\", this.ticker.deltaTime);\n\n            for (const system of this.systems) {\n                system.fire(\"update\", this.ticker.deltaTime);\n            }\n\n            for (const entity of this.entities) {\n                entity.fire(\"update\", this.ticker.deltaTime);\n            }\n        });\n    }\n\n    // ECS wrappers\n    e(options) {\n        return new Entity(this, options);\n    }\n\n    c(name, options) {\n        new Component(this, name, options);\n    }\n\n    s(options) {\n        new System(this, options);\n    }\n\n    // Scene wrapper\n    scene(name, options) {\n        if (options) new Scene(this, name, options);\n        else Scene.set(this, name);\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/application.js\n// module id = 10\n// module chunks = 0","export default class Component {\n    constructor(app, name, component) {\n        this.app = app;\n        this.name = name;\n        app.components[name] = this;\n\n        this.require = component.require;\n        this.attach = component.attach;\n        this.remove = component.remove;\n\n        delete component.require;\n        delete component.attach;\n        delete component.remove;\n\n        this.members = component;\n    }\n\n    attachTo(entity) {\n        if (this.require)\n        for (let req of this.require) {\n            this.app.components[req].attachTo(this);\n        }\n\n        this.attach.call(entity);\n\n        Object.defineProperties(entity, Object.getOwnPropertyDescriptors(this.members));\n    }\n\n    removeFrom(entity) {\n        this.remove.call(entity);\n\n        for (const member in this.members) delete entity[member];\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/component.js\n// module id = 11\n// module chunks = 0","import Vector from \"../vector\";\nimport mixinEventListener from \"./event-listener\";\n\nlet entityUID = 0;\n\nexport default class Entity extends PIXI.Container {\n    constructor(app, entity) {\n        super();\n        mixinEventListener(this);\n\n        this.app = app;\n        this.index = app.entities.push(this) - 1;\n        this.id = entityUID;\n        entityUID++;\n\n        this.components = entity.components;\n        for (const componentName of entity.components) {\n            this.attach(componentName);\n        }\n\n        for (const event in entity) {\n            if (event == \"components\" || event == \"parent\") continue;\n            this.bind(event, entity[event]);\n        }\n\n        if (entity.parent) entity.parent.addChild(this);\n\n        this.alive = true;\n        this.fire(\"ready\");\n\n        // TODO: fire global entityCreated event\n    }\n\n    // Free internal references\n    destroy(options) {\n        this.app.entities.splice(this.index, 1);\n        for (let i = this.index; i < this.app.entities.length; i++) {\n            this.app.entities[i].index -= 1;\n        }\n\n        super.destroy(options);\n\n        this.fire(\"destroyed\");\n\n        // TODO: fire global entityDestroyed event\n    }\n\n    queueDestroy() {\n        if (this.alive) {\n            this.app.destroyQueue.push(this);\n            this.alive = false;\n        }\n    }\n\n    // Return a particular entity\n    static get(id) {\n        for (const entity of this.app.entities) {\n            if (entity.id === id) return entity;\n        }\n    }\n\n    // Vector position\n    get position() { return new Vector(super.position); }\n    set position(v) { super.position.set(v.x, v.y); }\n\n    // Components\n    attach(componentName) {\n        const component = this.app.components[componentName];\n        if (!component) throw new Error(\"'\" + componentName + \"' is not a valid component name\");\n\n        component.attachTo(this);\n\n        this.components[componentName] = true;\n\n        this.fire(\"attachedComponent\", componentName);\n    }\n\n    remove(componentName) {\n        const component = this.app.components[componentName];\n        if (!component) throw new Error(\"'\" + componentName + \"' is not a valid component name\");\n\n        component.removeFrom(this);\n\n        this.components[componentName] = undefined;\n\n        this.fire(\"removedComponent\", { name: componentName });\n    }\n\n    has(componentName) {\n        if (this.components[componentName]) return true;\n        return false;\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/entity.js\n// module id = 12\n// module chunks = 0","export default class Scene {\n    constructor(app, name, scene) {\n        this.app = app;\n        app.scenes[name] = this;\n\n        this.enter = scene.enter;\n        this.exit = scene.exit;\n    }\n\n    static set(app, name) {\n        // TODO: Fire some events\n        // TODO: Delete entities, unbind event listeners, etc.\n        if (app.currentScene) app.scenes[app.currentScene].exit();\n\n        // Load new scene\n        app.currentScene = name;\n        app.scenes[name].enter();\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/scene.js\n// module id = 13\n// module chunks = 0","import mixinEventListener from \"./event-listener\";\n\nexport default class System {\n    constructor(app, system) {\n        mixinEventListener(this);\n\n        this.app = app;\n        app.systems.push(this);\n\n        this.require = system.require;\n\n        for (const event in system) {\n            if (event == \"require\") continue;\n            this.bind(event, system[event]);\n        }\n\n        this.fire(\"ready\");\n    }\n\n    // TODO: Optimize this?\n    // Maybe set when entities are added or removed from the app,\n    // instead of being a getter\n    get entities() {\n        return this.app.entities.filter((entity) => {\n            for (const componentName of this.require) {\n                if (entity.has(componentName)) return true;\n            }\n            return false;\n        });\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/system.js\n// module id = 14\n// module chunks = 0","export const collision = {\n    require: [\"collision\"],\n\n    update() {\n        // Check e against every other collidable entity\n        const entities = this.entities;\n        for (let i = 0; i < entities.length; i++) {\n            const e = entities[i];\n\n            // Draw debug rects\n            if (e.drawCollider) {\n                this.app.stage.graph\n                .lineStyle(0.25, 0xff0000)\n                .beginFill(0xff0000, 0.1);\n\n                if (e.r) this.app.stage.graph.drawCircle(e.x, e.y, e.r);\n                else this.app.stage.graph.drawRect(e.left, e.top, e.w, e.h);\n\n                this.app.stage.graph.endFill();\n            }\n\n            for (let j = 0; j < entities.length; j++) {\n                if (i == j) continue;\n                if (e.sleeping) continue;\n\n                const other = entities[j];\n\n                let hit;\n\n                // if both aabb (no radius)\n                if (!e.r && !other.r) {\n                    hit = testAABB(e, other);\n                }\n\n                // circle and aabb\n                else if (e.r && !other.r) {\n                    hit = testCircleAABB(e, other);\n                }\n\n                // aabb and circle\n                else if (!e.r && other.r) {\n                    hit = testCircleAABB(other, e);\n                }\n\n                // both circle\n                else if (e.r && other.r) {\n                    hit = testCircle(e, other);\n                }\n\n                if (hit) e.fire(\"collided\", other);\n            }\n        }\n    }\n};\n\nfunction testAABB(a, b) {\n    if (a.left < b.right &&\n        a.right > b.left &&\n        a.top < b.bottom &&\n        a.bottom > b.top\n    ) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction testCircleAABB(circle, aabb) {\n    const p = circle.position.copy();\n\n    if (p.x < aabb.left)    p.x = aabb.left;\n    if (p.x > aabb.right)   p.x = aabb.right;\n    if (p.y < aabb.top)     p.y = aabb.top;\n    if (p.y > aabb.bottom)  p.y = aabb.bottom;\n\n    if (p.minus(circle.position).length < circle.r) return true;\n\n    return false;\n}\n\nfunction testCircle(a, b) {\n    if (a.position.minus(b.position).length < a.r + b.r) return true;\n\n    return false;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/systems/collision.js\n// module id = 15\n// module chunks = 0","export { steering } from \"./steering\";\nexport { physics } from \"./physics\";\nexport { collision } from \"./collision\";\nexport { particles } from \"./particles\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/systems/index.js\n// module id = 16\n// module chunks = 0","import Vector from \"../vector\";\n\n// TODO: object pool for particles\n// TODO: access emitter velocity from particle constructor\n\nexport const particles = {\n    require: [\"emitter\"],\n\n    update(dt) {\n        for (const e of this.entities) {\n            if (e.emitting) {\n                e.emitTimer -= this.app.ticker.elapsedMS;\n\n                if (e.emitTimer <= 0) {\n                    e.emitTimer = e.emitOptions.period || 50;\n\n                    const particle = new Particle(this.app, e.emitOptions);\n\n                    // TODO: Find a way to this to constructor\n                    const globalPos = e.toGlobal(this.app.stage.position);\n                    particle.position.set(\n                        globalPos.x / this.app.stage.scale.x + (((Math.random() - 0.5) * e.emitOptions.area) || 0),\n                        globalPos.y / this.app.stage.scale.y + (((Math.random() - 0.5) * e.emitOptions.area) || 0)\n                    );\n                }\n            }\n        }\n\n        for (const particle of this.app.stage.particles.children) {\n            particle.process(dt);\n        }\n    }\n};\n\nconst defaultTexture = new PIXI.Graphics()\n.beginFill(0xff4411)\n.drawRect(0,0,1,1)\n.endFill()\n.generateCanvasTexture(PIXI.SCALE_MODES.LINEAR);\n\nclass Particle extends PIXI.Sprite {\n    constructor(app, options) {\n        super(options.texture || defaultTexture);\n        app.stage.particles.addChild(this);\n        this.app = app;\n        this.anchor.set(0.5);\n\n        this.lifetime = options.lifetime || 300;\n        this.life = this.lifetime;\n\n        // Set starting properties\n        this.scale.set(options.scale || 1);\n        this.rotation = options.rotation || 0;\n        this.alpha = options.alpha || 1;\n        this.velocity = options.velocity ? options.velocity.copy() : new Vector();\n\n        // Calculate randomness for starting properties\n        if (options.scaleRandom)\n            this.scale.set(this.scale + ((Math.random() - 0.5) * options.scaleRandom));\n        if (options.rotationRandom)\n            this.rotation += (Math.random() - 0.5) * options.rotationRandom;\n        if (options.alphaRandom)\n            this.alpha += (Math.random() - 0.5) * options.alphaRandom;\n        if (options.velocityRandom)\n            this.velocity.add(new Vector(\n                (Math.random() - 0.5) * options.velocityRandom.x,\n                (Math.random() - 0.5) * options.velocityRandom.y\n            ));\n\n        // Set ending properties\n        this.endScale = options.endScale || this.scale.x;\n        this.endRotation = options.endRotation || this.rotation;\n        this.endAlpha = options.endAlpha || this.alpha;\n\n        // Calculate randomness for ending properties\n        if (options.endScaleRandom)\n            this.endScale += (Math.random() - 0.5) * options.endScaleRandom;\n        if (options.endRotationRandom)\n            this.endRotation += (Math.random() - 0.5) * options.endRotationRandom;\n        if (options.endAlphaRandom)\n            this.endAlpha += (Math.random() - 0.5) * options.endAlphaRandom;\n\n        // Set/calculate property deltas\n        this.scaleDelta = options.scaleDelta || (this.endScale - this.scale.x) / this.lifetime * (1000/60);\n        this.rotationDelta = options.rotationDelta || (this.endRotation - this.rotation) / this.lifetime * (1000/60);\n        this.alphaDelta = options.alphaDelta || (this.endAlpha - this.alpha) / this.lifetime * (1000/60);\n    }\n\n    process(dt) {\n        // Update properties each frame\n        this.scale.x += this.scaleDelta * dt;\n        this.scale.y += this.scaleDelta * dt;\n\n        this.rotation += this.rotationDelta * dt;\n\n        this.alpha += this.alphaDelta * dt;\n\n        this.position.x += this.velocity.x * dt;\n        this.position.y += this.velocity.y * dt;\n\n        this.life -= this.app.ticker.elapsedMS;\n\n        if (this.life <= 0 || this.scale.x <= 0 || this.alpha <= 0) {\n            this.destroy();\n        }\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/systems/particles.js\n// module id = 17\n// module chunks = 0","export const physics = {\n    require: [\"motion\"],\n\n    update(dt) {\n        for (const e of this.entities) {\n            // Integrate velocity with position\n            e.position = e.position.add(e.velocity.times(dt));\n        }\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/systems/physics.js\n// module id = 18\n// module chunks = 0","export const steering = {\n    require: [\"steering\"],\n\n    update(dt) {\n        for (const e of this.entities) {\n            if (e.steer) {\n                const desired = e.desiredVelocity;\n\n                // Apply chase velocity\n                if (e.chaseVec) desired.add(e.chaseVec.minus(e.position));\n\n                // Apply avoid velocities\n                // TODO: multipliers for each avoid vec\n                for (const avoidVec of e.avoidVecs) {\n                    // Scale diff by inverse square of distance and add to desired\n                    const diff = e.position.minus(avoidVec);\n                    desired.add(diff.multiply(1 / Math.pow(diff.length, 2)));\n                }\n\n                // Calculate steering force\n                const sforce = desired.minus(e.velocity).truncate(e.turnSpeed);\n\n                // Integrate steering force with current velocity\n                e.velocity.add(sforce).truncate(e.moveSpeed);\n                desired.set(0);\n            }\n        }\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/systems/steering.js\n// module id = 19\n// module chunks = 0","export * from \"./core\";\n\nexport { default as Vector } from \"./vector\";\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}